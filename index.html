
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Program Status â€” Roadmap (Singleâ€‘file, GitHub Pages Ready)</title>
<style>
/* ========= THEME ========= */
:root{
  --bg:#0b1220; --panel:#0f172a; --panel-2:#111827; --text:#e5e7eb; --muted:#94a3b8; --border:#1f2937;
  --accent:#60a5fa; --accent-2:#22d3ee; --good:#22c55e; --warn:#60a5fa; --bad:#ef4444; --idle:#64748b;
  --chip-bg:rgba(255,255,255,.06); --shadow:0 6px 18px rgba(0,0,0,.4), 0 1px 0 rgba(255,255,255,.04) inset;
}
[data-theme="emerald"]{--accent:#34d399;--accent-2:#22d3ee}
[data-theme="sunset"]{--accent:#f59e0b;--accent-2:#f472b6}
[data-theme="crimson"]{--accent:#ef4444;--accent-2:#f59e0b}
[data-theme="azure"]{--accent:#60a5fa;--accent-2:#22d3ee}

/* ========= BASE ========= */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
   radial-gradient(1200px 600px at 70% -10%, rgba(167,139,250,.18), transparent 60%),
   radial-gradient(900px 600px at 10% 10%, rgba(34,211,238,.15), transparent 60%),
   var(--bg);
  color:var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
}
a,button,select{font:inherit;color:inherit}

.wrapper{max-width:1200px;margin:0 auto;padding:20px 16px 56px}

header.appbar{
  position:sticky; top:0; z-index:50; backdrop-filter: blur(10px);
  background:linear-gradient(to right, rgba(15,23,42,.85), rgba(17,24,39,.85));
  border-bottom:1px solid var(--border);
}
.appbar .bar{
  max-width:1200px; margin:0 auto; padding:12px 16px; display:flex; gap:12px; align-items:center; justify-content:space-between;
}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:28px;height:28px;border-radius:8px;background:conic-gradient(from 200deg,var(--accent),var(--accent-2));box-shadow:var(--shadow)}
.title{font-weight:700;letter-spacing:.2px}
.controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}

.btn{
  background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  border:1px solid var(--border); color:var(--text);
  padding:8px 12px;border-radius:10px;cursor:pointer; box-shadow:var(--shadow);
}
.btn:hover{border-color:rgba(255,255,255,.22)}
.btn.ghost{background:transparent;border:1px dashed var(--border);color:var(--muted)}

select.theme{
  padding:8px 10px;border-radius:10px;background:var(--panel);
  border:1px solid var(--border);color:var(--text);
}

.legend{margin:16px 0 8px;display:flex;align-items:center;gap:16px;flex-wrap:wrap;color:var(--muted)}
.pill{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:var(--chip-bg);border:1px solid var(--border)}
.k{width:8px;height:8px;border-radius:50%;background:var(--idle);display:inline-block}
.k.g{background:var(--good)} .k.b{background:var(--bad)} .k.w{background:var(--warn)}

.grid{display:grid;grid-template-columns:340px 1fr;gap:18px;align-items:start;margin-top:12px}

/* Sidebar */
.phases{
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid var(--border); border-radius:14px; padding:10px; box-shadow:var(--shadow);
  position:sticky; top:64px;
}
.phases h3{margin:6px 10px 10px;font-size:14px;color:var(--muted);font-weight:600}
.phase-item{border:1px solid var(--border);border-radius:12px;padding:10px;margin:10px;background:var(--panel);cursor:pointer}
.phase-item.active{outline:2px solid var(--accent)}
.phase-top{display:flex;align-items:center;justify-content:space-between;gap:8px}
.phase-title{font-weight:700}
.progressbar{height:8px;background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:999px;margin-top:10px;overflow:hidden}
.progressbar>span{display:block;height:100%;background:linear-gradient(to right, var(--accent), var(--accent-2));width:0%}

/* Main */
.panel{
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid var(--border); border-radius:14px; padding:12px; box-shadow:var(--shadow);
}
.phase-headline{display:flex;align-items:center;justify-content:space-between;padding:10px 10px 4px}
.status-badge{padding:6px 10px;border-radius:999px;font-weight:600;letter-spacing:.2px;border:1px solid var(--border);background:var(--chip-bg);color:var(--muted)}
.status-badge.completed{color:var(--good)} .status-badge.blocked{color:var(--bad)} .status-badge.in_progress{color:var(--warn)}

.step{border:1px solid var(--border);border-radius:12px;padding:10px;margin:10px 6px;background:var(--panel-2)}
.step-top{display:flex;align-items:center;justify-content:space-between;gap:10px}
.step-title{font-weight:700}
.step-meta{display:flex;align-items:center;gap:8px;color:var(--muted)}
.step-status-chip{border:1px solid var(--border);border-radius:999px;padding:4px 8px;font-size:12px;background:var(--chip-bg)}
.step-status-chip.completed{color:var(--good)} .step-status-chip.blocked{color:var(--bad)} .step-status-chip.in_progress{color:var(--warn)}

.tasklist{margin-top:10px;display:grid;gap:8px}
.task{
  display:grid;grid-template-columns:32px minmax(120px,1fr) auto;gap:10px;align-items:center;
  border:1px solid var(--border);border-radius:10px;padding:8px 10px;background:rgba(255,255,255,.03)
}
.task .slot{display:flex;align-items:center;gap:8px}
.task .title{background:transparent;border:0;border-bottom:1px dashed transparent;color:var(--text);padding:2px 0;outline:none}
[data-edit="true"] .task .title{border-bottom-color:var(--border)}
.chips{display:inline-flex;gap:6px}
.chip{padding:4px 8px;border-radius:999px;border:1px solid var(--border);background:var(--chip-bg);cursor:pointer;font-size:12px;color:var(--muted)}
.chip.active.not_started{color:var(--idle);outline:1px solid var(--idle)}
.chip.active.in_progress{color:var(--warn);outline:1px solid var(--warn)}
.chip.active.completed{color:var(--good);outline:1px solid var(--good)}
.chip.active.blocked{color:var(--bad);outline:1px solid var(--bad)}

.divider{height:1px;background:var(--border);margin:10px 0}
.iconbtn{width:30px;height:30px;border-radius:8px;border:1px solid var(--border);background:var(--chip-bg);cursor:pointer}
.iconbtn:hover{border-color:rgba(255,255,255,.22)}
.muted{color:var(--muted)}
.right{display:flex;gap:8px;align-items:center}
.footer-actions{margin-top:14px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;color:var(--muted)}
#exportTarget{padding:6px}

@media (max-width:900px){.grid{grid-template-columns:1fr}.phases{position:static}}

/* ===== PRINT (PDF) ===== */
@media print{
  body{background:#fff}
  header.appbar,.controls,.legend .muted,.footer-actions{display:none !important}
  .wrapper{max-width:100%;padding:0;margin:0}
  .grid{grid-template-columns:1fr}
  .phases{position:static;top:auto;page-break-after:always}
  .panel,.phases{border-color:#ddd; box-shadow:none; background:#fff}
  .task{background:#fff}
}
</style>
</head>
<body data-theme="azure">
  <header class="appbar">
    <div class="bar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">Program Status â€” Roadmap</div>
          <div class="muted" style="font-size:12px;">Single-file â€¢ GitHub Pages â€¢ Local storage</div>
        </div>
      </div>
      <div class="controls">
        <select id="themePicker" class="theme" title="Theme">
          <option value="azure" selected>Theme: Azure</option>
          <option value="emerald">Theme: Emerald</option>
          <option value="sunset">Theme: Sunset</option>
          <option value="crimson">Theme: Crimson</option>
        </select>
        <button id="toggleEdit" class="btn">Edit</button>
        <button id="exportPDF" class="btn">Export PDF</button>
        <button id="exportJSON" class="btn ghost">Export JSON</button>
        <button id="importJSON" class="btn ghost">Import JSON</button>
        <button id="resetData" class="btn ghost" title="Clear local data">Reset</button>
      </div>
    </div>
  </header>

  <div class="wrapper">
    <div class="legend">
      <span class="pill"><span class="k g"></span> Complete (âœ“)</span>
      <span class="pill"><span class="k w"></span> In Progress (âžœ)</span>
      <span class="pill"><span class="k"></span> Not Started (â€¢)</span>
      <span class="pill"><span class="k b"></span> Blocked (âœ—)</span>
      <span class="muted">Tip: Toggle <b>Edit</b> to add/rename/delete items.</span>
    </div>

    <div id="exportTarget" class="grid">
      <aside class="phases" id="phasesSidebar" aria-label="Phases"></aside>
      <section class="panel" id="mainPanel" aria-live="polite"></section>
    </div>

    <div class="footer-actions">
      <span>All changes are saved locally in your browser.</span>
    </div>
  </div>

<script>
/* Program Status â€” Roadmap (Single-file SPA) */
(function(){
  "use strict";

  // ---------- Utilities / Storage ----------
  var LS_KEY = "roadmap_singlefile_v1";
  function genId(){ return Math.random().toString(36).slice(2,9); }
  function nowISO(){ return new Date().toISOString(); }
  function $(sel,root){ return (root||document).querySelector(sel); }
  function escapeHtml(s){ return String(s||"").replace(/[&<>"']/g,function(m){return ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])}); }
  function escapeAttr(s){ return escapeHtml(s); }

  var STATUS = ["not_started","in_progress","completed","blocked"];
  var STATUS_LABEL = {
    not_started:"Not Started â€¢",
    in_progress:"In Progress âžœ",
    completed:"Completed âœ“",
    blocked:"Blocked âœ—"
  };

  function defaultData(){
    return {
      meta:{createdAt:nowISO(),updatedAt:nowISO(),title:"Program Status â€” Roadmap"},
      phases:[
        {id:genId(), title:"Phase 1", steps:[]},
        {id:genId(), title:"Phase 2", steps:[]},
        {id:genId(), title:"Phase 3", steps:[]},
        {id:genId(), title:"Phase 4", steps:[]}
      ],
      activePhaseId:null
    };
  }

  function loadData(){
    try{
      var raw = localStorage.getItem(LS_KEY);
      if(!raw) return defaultData();
      var parsed = JSON.parse(raw);
      if(!parsed || !parsed.phases || !Array.isArray(parsed.phases)) return defaultData();
      return parsed;
    }catch(e){
      console.warn("loadData fallback:", e);
      return defaultData();
    }
  }

  var data = loadData();
  if(!data.activePhaseId && data.phases[0]) data.activePhaseId = data.phases[0].id;

  function saveData(){
    data.meta.updatedAt = nowISO();
    localStorage.setItem(LS_KEY, JSON.stringify(data));
    render();
  }

  function resetData(){
    if(!confirm("This will clear your local data. Continue?")) return;
    localStorage.removeItem(LS_KEY);
    data = defaultData();
    if(!data.activePhaseId && data.phases[0]) data.activePhaseId = data.phases[0].id;
    render();
  }

  // ---------- Aggregation ----------
  function aggregateFromTasks(tasks){
    if(!tasks || tasks.length===0) return {status:"not_started", pct:0};
    var counts = {not_started:0,in_progress:0,completed:0,blocked:0};
    for(var i=0;i<tasks.length;i++){ counts[tasks[i].status] = (counts[tasks[i].status]||0)+1; }
    var status = "not_started";
    if(counts.blocked>0) status="blocked";
    else if(counts.completed===tasks.length) status="completed";
    else if(counts.in_progress>0 || (counts.completed>0 && counts.completed<tasks.length)) status="in_progress";
    var pct = Math.round((counts.completed/tasks.length)*100);
    return {status:status, pct:pct};
  }
  function aggregateStep(step){ return aggregateFromTasks(step.tasks||[]); }
  function aggregatePhase(phase){
    if(!phase.steps || phase.steps.length===0) return {status:"not_started", pct:0};
    var totals = 0;
    var anyBlocked=false, allCompleted=true, anyInProgress=false;
    for(var i=0;i<phase.steps.length;i++){
      var sa = aggregateStep(phase.steps[i]);
      totals += sa.pct;
      if(sa.status==="blocked") anyBlocked=true;
      if(sa.status!=="completed") allCompleted=false;
      if(sa.status==="in_progress") anyInProgress=true;
      if(sa.status==="not_started" && (phase.steps[i].tasks||[]).length>0) allCompleted=false;
    }
    var avg = Math.round(totals/phase.steps.length);
    var status = "not_started";
    if(anyBlocked) status="blocked";
    else if(allCompleted) status="completed";
    else if(anyInProgress) status="in_progress";
    return {status:status, pct:avg};
  }

  // ---------- Rendering ----------
  function renderPhasesSidebar(){
    var sb = $("#phasesSidebar");
    sb.innerHTML = "<h3>Phases</h3>";
    for(var i=0;i<data.phases.length;i++){
      (function(phase){
        var agg = aggregatePhase(phase);
        var isActive = data.activePhaseId===phase.id;
        var el = document.createElement("div");
        el.className = "phase-item"+(isActive?" active":"");
        el.innerHTML =
          '<div class="phase-top">'+
            '<div class="phase-title">'+escapeHtml(phase.title)+'</div>'+
            '<div class="status-badge '+agg.status+'">'+STATUS_LABEL[agg.status]+'</div>'+
          '</div>'+
          '<div class="progressbar" aria-label="progress '+agg.pct+'%"><span style="width:'+agg.pct+'%"></span></div>';
        el.addEventListener("click", function(){
          data.activePhaseId = phase.id;
          render();
        });
        sb.appendChild(el);
      })(data.phases[i]);
    }
    if(getEditMode()){
      var add = document.createElement("div");
      add.className = "phase-item";
      add.innerHTML = '<button class="btn" style="width:100%;">+ Add Phase</button>';
      add.querySelector("button").addEventListener("click", function(){
        var title = prompt("New phase title:", "Phase "+(data.phases.length+1));
        if(!title) return;
        data.phases.push({id:genId(),title:title.trim(),steps:[]});
        data.activePhaseId = data.phases[data.phases.length-1].id;
        saveData();
      });
      sb.appendChild(add);
    }
  }

  function renderTaskRow(step, task){
    var row = document.createElement("div");
    row.className = "task";
    row.dataset.taskId = task.id;
    row.innerHTML =
      '<div class="slot">'+
        (getEditMode()?'<button class="iconbtn" title="Delete task" datale="width:30px;display:inline-block;text-align:center;">â€¢</span>')+
      '</div>'+
      '<div class="slot">'+
        '<input class="title" type="text" value="'+escapeAttr(task.title)+'" '+(getEditMode()?"":"readonly")+' />'+
      '</div>'+
      '<div class="slot chips">'+
        STATUS.map(function(s){
          return '<span class="chip '+s+' '+(task.status===s?'active':'')+'" data-status="'+s+'">'+STATUS_LABEL[s]+'</span>';
        }).join("")+
      '</div>';

    var titleInput = row.querySelector(".title");
    titleInput.addEventListener("change", function(){
      if(!getEditMode()) return;
      task.title = titleInput.value.trim();
      task.updatedAt = nowISO();
      saveData();
    });

    row.addEventListener("click", function(e){
      var btn = e.target.closest("button");
      if(btn && btn.getAttribute("data-action")==="delete-task"){
        if(!getEditMode()) return;
        if(!confirm("Delete this task?")) return;
        step.tasks = (step.tasks||[]).filter(function(t){ return t!==task; });
        saveData();
        return;
      }
      var chip = e.target.closest(".chip");
      if(chip){
        task.status = chip.getAttribute("data-status");
        task.updatedAt = nowISO();
        saveData();
      }
    });
    return row;
  }

  function renderMainPanel(){
    var panel = $("#mainPanel");
    var active = null;
    for(var i=0;i<data.phases.length;i++){
      if(data.phases[i].id===data.activePhaseId){ active = data.phases[i]; break; }
    }
    if(!active && data.phases[0]) active = data.phases[0];
    if(!active){
      panel.innerHTML = '<div class="muted">No phases yet. Click <b>Edit</b> and add your first phase.</div>';
      return;
    }
    var agg = aggregatePhase(active);

    var frag = document.createDocumentFragment();

    // Header
    var header = document.createElement("div");
    header.className = "phase-headline";
    header.innerHTML =
      '<div style="display:flex;align-items:center;gap:8px;">'+
        '<h2 style="margin:0;">'+escapeHtml(active.title)+'</h2>'+
        '<span class="status-badge '+agg.status+'">'+STATUS_LABEL[agg.status]+'</span>'+
      '</div>'+
      '<div class="right">'+
        '<div class="muted">'+active.steps.length+' steps â€¢ '+agg.pct+'% complete</div>'+
        (getEditMode()?'<button class="btn" id="renamePhaseBtn">Rename</button><button class="btn" id="deletePhaseBtn">Delete</button>':'')+
      '</div>';
    frag.appendChild(header);

    // Steps
    var stepsContainer = document.createElement("div");
    stepsContainer.id = "stepsContainer";

    for(var s=0; s<active.steps.length; s++){
      (function(step){
        var sa = aggregateStep(step);
        var stepEl = document.createElement("div");
        stepEl.className = "step";
        stepEl.innerHTML =
          '<div class="step-top">'+
            '<div class="step-title">'+escapeHtml(step.title)+'</div>'+
            '<div class="step-meta">'+
              '<span class="step-status-chip '+sa.status+'">'+STATUS_LABEL[sa.status]+'</span>'+
              '<span class="muted">'+sa.pct+'%</span>'+
              (getEditMode()?'rename-stepâœŽ</button>delete-stepðŸ—‘</button>':'')+
            '</div>'+
          '</div>'+
          '<div class="divider"></div>'+
          '<div class="tasklist"></div>'+
          (getEditMode()?'<div style="margin-top:8px;">add-task+ Add Task</button></div>':'');
        var tl = stepEl.querySelector(".tasklist");
        var tasks = step.tasks||[];
        for(var ti=0;ti<tasks.length;ti++){ tl.appendChild(renderTaskRow(step, tasks[ti])); }

        stepEl.addEventListener("click", function(e){
          var btn = e.target.closest("button");
          if(!btn) return;
          var action = btn.getAttribute("data-action");
          if(action==="rename-step"){
            var name = prompt("Rename step:", step.title);
            if(!name) return;
            step.title = name.trim(); saveData();
          }else if(action==="delete-step"){
            if(!confirm("Delete this step and its tasks?")) return;
            active.steps = active.steps.filter(function(x){ return x!==step; });
            saveData();
          }else if(action==="add-task"){
            var tTitle = prompt("Task title:", "New task");
            if(!tTitle) return;
            step.tasks = step.tasks||[];
            step.tasks.push({id:genId(), title:tTitle.trim(), status:"not_started", updatedAt:nowISO()});
            saveData();
          }
        });

        stepsContainer.appendChild(stepEl);
      })(active.steps[s]);
    }

    if(getEditMode()){
      var addStepBox = document.createElement("div");
      addStepBox.style = "margin:10px 6px;";
      addStepBox.innerHTML = '<button class="btn">+ Add Step</button>';
      addStepBox.querySelector("button").addEventListener("click", function(){
        var title = prompt("New step title:", "Step "+(active.steps.length+1));
        if(!title) return;
        active.steps.push({id:genId(), title:title.trim(), tasks:[]});
        saveData();
      });
      stepsContainer.appendChild(addStepBox);
    }

    frag.appendChild(stepsContainer);
    panel.innerHTML = "";
    panel.appendChild(frag);

    // Phase header actions
    if(getEditMode()){
      var rpb = $("#renamePhaseBtn");
      if(rpb) rpb.addEventListener("click", function(){
        var name = prompt("Rename phase:", active.title);
        if(!name) return;
        active.title = name.trim(); saveData();
      });
      var dpb = $("#deletePhaseBtn");
      if(dpb) dpb.addEventListener("click", function(){
        if(!confirm("Delete this phase and everything inside it?")) return;
        data.phases = data.phases.filter(function(p){ return p!==active; });
        data.activePhaseId = data.phases[0]? data.phases[0].id : null;
        saveData();
      });
    }
  }

  function render(){
    document.body.setAttribute("data-edit", getEditMode()?"true":"false");
    renderPhasesSidebar();
    renderMainPanel();
  }

  // ---------- Edit mode ----------
  function getEditMode(){ return localStorage.getItem(LS_KEY+"_edit")==="true"; }
  function setEditMode(v){ localStorage.setItem(LS_KEY+"_edit", v?"true":"false"); }

  // ---------- Export (PDF via Print), JSON ----------
  function exportPDF(){
    // Uses print stylesheet for a clean PDF. User selects "Save as PDF".
    window.print();
  }
  function exportJSON(){
    var blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a"); a.href=url; a.download="roadmap_data_"+new Date().toISOString().slice(0,10)+".json"; a.click();
    URL.revokeObjectURL(url);
  }
  function importJSON(){
    var input = document.createElement("input");
    input.type="file"; input.accept="application/json";
    input.onchange = function(){
      var file = input.files[0]; if(!file) return;
      var reader = new FileReader();
      reader.onload = function(){
        try{
          var imported = JSON.parse(reader.result);
          if(!imported.phases || !Array.isArray(imported.phases)) throw new Error("Invalid file");
          data = imported;
          if(!data.activePhaseId && data.phases[0]) data.activePhaseId = data.phases[0].id;
          saveData();
        }catch(e){
          alert("Invalid JSON file.");
        }
      };
      reader.readAsText(file);
    };
    input.click();
  }

  // ---------- Init / Events ----------
  function init(){
    // Theme
    var themePicker = $("#themePicker");
    var savedTheme = localStorage.getItem(LS_KEY+"_theme") || "azure";
    document.body.setAttribute("data-theme", savedTheme);
    themePicker.value = savedTheme;
    themePicker.addEventListener("change", function(){
      document.body.setAttribute("data-theme", themePicker.value);
      localStorage.setItem(LS_KEY+"_theme", themePicker.value);
    });

    // Controls
    var toggle = $("#toggleEdit");
    toggle.addEventListener("click", function(){
      var newMode = !getEditMode();
      setEditMode(newMode);
      toggle.textContent = newMode ? "Done" : "Edit";
      render();
    });
    toggle.textContent = getEditMode() ? "Done" : "Edit";

    $("#exportPDF").addEventListener("click", exportPDF);
    $("#exportJSON").addEventListener("click", exportJSON);
    $("#importJSON").addEventListener("click", importJSON);
    $("#resetData").addEventListener("click", resetData);

    render();
    console.log("App ready");
  }

  document.addEventListener("DOMContentLoaded", init);
})();
</script>
</body>
</html>
